import{A as c,D as d,F as h,G as l,H as m,I as w}from"./chunk-Z2ILHMVL.js";import{b as u,j as n,l as o}from"./chunk-3L7FN3TJ.js";import{f as r}from"./chunk-D7YYRZS5.js";var g=(()=>{let a=class a{constructor(t){this.auth=t,this.currentUserSubject=new u(null),this.currentUser$=this.currentUserSubject.asObservable(),h(this.auth,e=>{if(e){let i={uid:e.uid,email:e.email,displayName:e.displayName||void 0,createdAt:new Date(e.metadata.creationTime)};this.currentUserSubject.next(i)}else this.currentUserSubject.next(null)})}get currentUser(){return this.currentUserSubject.value}get isAuthenticated(){return this.currentUser!==null}register(t){return r(this,null,function*(){try{let e=yield d(this.auth,t.email,t.password);return t.displayName&&(yield w(e.user,{displayName:t.displayName})),{uid:e.user.uid,email:e.user.email,displayName:t.displayName,createdAt:new Date}}catch(e){throw this.handleAuthError(e)}})}login(t){return r(this,null,function*(){try{let e=yield l(this.auth,t.email,t.password);return{uid:e.user.uid,email:e.user.email,displayName:e.user.displayName||void 0,createdAt:new Date(e.user.metadata.creationTime)}}catch(e){throw this.handleAuthError(e)}})}logout(){return r(this,null,function*(){try{yield m(this.auth)}catch(t){throw this.handleAuthError(t)}})}handleAuthError(t){let e="An error occurred during authentication.";switch(t.code){case"auth/user-not-found":e="No user found with this email address.";break;case"auth/wrong-password":e="Incorrect password.";break;case"auth/email-already-in-use":e="An account with this email already exists.";break;case"auth/weak-password":e="Password should be at least 6 characters.";break;case"auth/invalid-email":e="Invalid email address.";break;case"auth/too-many-requests":e="Too many failed attempts. Please try again later.";break;default:e=t.message||e}return new Error(e)}};a.\u0275fac=function(e){return new(e||a)(o(c))},a.\u0275prov=n({token:a,factory:a.\u0275fac,providedIn:"root"});let s=a;return s})();export{g as a};
